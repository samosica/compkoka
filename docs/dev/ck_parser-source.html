<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="initial-scale=1.0" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Nunito:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>parser.kk documentation</title>
</head>

<body class="koka doc body madoko">
<pre class="koka source"><span class="comment">// Parser functions
</span><span class="kw">module</span> <a class="pp" href="ck_parser.html#_null_"><span class="mo">ck/parser</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>parser</span></span></a>

<span class="kw">import</span> <a class="pp" href="std_num_float64.html#_null_"><span class="mo">std/num/float64</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>float64</span></span></a>

<span class="decl-fun" id="int"><span class="kw">pub</span> <span class="kw">inline</span> <span class="kw">fun</span> <a class="pp" href="ck_parser.html#int">int<span class="pc"><span class="mo">ck<span class="fslash">/</span>parser<span class="fslash last">/</span></span>int: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">int</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>
  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_int-source.html#parse_int">parse-int<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>parse<span class="dash">-</span>int: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">hex</span> <span class="tp kw op">:</span> <span class="tp sp">?</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_maybe-source.html#unjust">unjust<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>maybe<span class="fslash last">/</span></span>unjust: <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>kk<span class="dash">-</span>file<span class="dash">-</span>line</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">int</span><br>?kk-file-line=debug/file/kk-file-line(debug/file/kk-file,debug/file/kk-line)</span></a></span>

<span class="decl-fun" id="float64"><span class="kw">pub</span> <span class="kw">inline</span> <span class="kw">fun</span> <a class="pp" href="ck_parser.html#float64">float64<span class="pc"><span class="mo">ck<span class="fslash">/</span>parser<span class="fslash last">/</span></span>float64: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">float64</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">float64</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a> <a class="pp" href="std_core_types-source.html#type_space_float64"><span class="tp">float64</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>float64: <span class="co">V</span></span></a>
  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_float64-source.html#parse_float64">parse-float64<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>float64<span class="fslash last">/</span></span>parse<span class="dash">-</span>float64: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">float64</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_maybe-source.html#unjust">unjust<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>maybe<span class="fslash last">/</span></span>unjust: <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">float64</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>kk<span class="dash">-</span>file<span class="dash">-</span>line</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">float64</span><br>?kk-file-line=debug/file/kk-file-line(debug/file/kk-file,debug/file/kk-line)</span></a></span>

<span class="decl-fun" id="string"><span class="kw">pub</span> <span class="kw">inline</span> <span class="kw">fun</span> <a class="pp" href="ck_parser.html#string">string<span class="pc"><span class="mo">ck<span class="fslash">/</span>parser<span class="fslash last">/</span></span>string: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">string</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="co">V</span></span></a>
  </span><a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a>

<span class="comment">// Note: in a benchmark, a safe version of char checking the argument was
// 1.82 times slower than the original version.
</span>
<span class="comment">// Parse a single character.
// N.B. this function does not check whether a given string consist of a single
// character due to performance issue.
</span><span class="decl-fun" id="char"><span class="kw">pub</span> <span class="kw">inline</span> <span class="kw">fun</span> <a class="pp" href="ck_parser.html#char">char<span class="pc"><span class="mo">ck<span class="fslash">/</span>parser<span class="fslash last">/</span></span>char: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">char</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">char</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a> <a class="pp" href="std_core_types-source.html#type_space_char"><span class="tp">char</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>char: <span class="co">V</span></span></a>
  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_sslice-source.html#head_char">head-char<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>sslice<span class="fslash last">/</span></span>head<span class="dash">-</span>char: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_maybe-source.html#unjust">unjust<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>maybe<span class="fslash last">/</span></span>unjust: <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>kk<span class="dash">-</span>file<span class="dash">-</span>line</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">char</span><br>?kk-file-line=debug/file/kk-file-line(debug/file/kk-file,debug/file/kk-line)</span></a></span>

<span class="decl-fun" id="list"><span class="kw">pub</span> <span class="kw">inline</span> <span class="kw">fun</span> <a class="pp" href="ck_parser.html#list">list<span class="pc"><span class="mo">ck<span class="fslash">/</span>parser<span class="fslash last">/</span></span>list: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">parse</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>(<a class="pp">parse<span class="pc">parse: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp op">$</span><span class="number">105</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="co">V</span></span></a> <span class="tp kw op">-></span> <a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="number">165</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">(</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><span class="tp tpp">s</span><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="co">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a> <a class="pp" href="std_core_types-source.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>list: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">)</span>
  <a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">105</span><span class="op">&gt;</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a>) { <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_string-source.html#sep_fs_split">split<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>string<span class="fslash last">/</span></span><span class="lq">sep<span class="fslash">/</span></span>split: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">sep</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">" "<span class="pc">literal: <span class="tp">string</span><br>count= 1</span></a>)<span class="kw op">.</span><a class="pp" href="std_core_list-source.html#map">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>list<span class="fslash last">/</span></span>map: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp op">$</span><span class="number">105</span>) <span class="kw op">-></span> exn list<span class="op">&lt;$</span><span class="number">105</span><span class="op">&gt;</span></span></a>(<a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp sp">(</span><span class="tp tpp">s'</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp op">$</span><span class="number">105</span></span></a>(<a class="pp">s'<span class="pc">s': <span class="tp">string</span></span></a>) <a class="pp">s'<span class="pc">s': <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp">parse<span class="pc">parse: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp op">$</span><span class="number">105</span></span></a>) </span>}
</pre>

</body>
</html>
