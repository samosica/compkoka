<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="initial-scale=1.0" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Nunito:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>segtree.kk documentation</title>
</head>

<body class="koka doc body madoko">
<pre class="koka source"><span class="comment">/&#42; Segment tree

Usage:

&#96;&#96;&#96;
import ck/segtree

// 1. Define a monoid
fun mon(): monoid&lt;int&gt;
  Monoid(0, (+))

fun main()
  // 2. Create a segment tree
  val t = segtree(10, mon())

  // 3. Manipulate it (see below)
  t.set(1, 3)
  t.set(3, 8)
  t.product(0, 10).println // 11
&#96;&#96;&#96;
\/
&#42;/</span>
<span class="kw">module</span> <a class="pp" href="ck_segtree.html#_null_"><span class="mo">ck/segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree</span></span></a>

<span class="kw">import</span> <a class="pp" href="std_core_undiv.html#_null_"><span class="mo">std/core/undiv</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>undiv</span></span></a>

<span class="decl-reference type" id="type_space_monoid"><span class="kw">pub</span> <span class="tp kw">struct</span> <span class="decl-con" id="con_space_Monoid"><a class="pp" href="ck_segtree.html#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
  <a class="pp" href="ck_segtree.html#monoid_fs_one">one<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>one: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a> <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a>
  <a class="pp" href="ck_segtree.html#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">,</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> </span></span><a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">a</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a>

<span class="decl-reference type" id="type_space_segtree"><span class="kw">abstract</span> <span class="tp kw">struct</span> <span class="decl-con" id="con_space_Segtree"><a class="pp" href="ck_segtree.html#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
  <a class="pp" href="ck_segtree.html#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_ref"><span class="tp">ref</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_vector"><span class="tp">vector</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>vector: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span>
  <a class="pp" href="ck_segtree.html#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>
  <a class="pp" href="ck_segtree.html#segtree_fs_mon">mon<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>mon: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a></span></span><span class="tp sp">&gt;</span>

<span class="comment">// Create a segment tree
</span><span class="decl-fun" id="segtree"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#segtree">segtree<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">mon</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">mon<span class="pc">mon: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">394</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="number">615</span><span class="op">&gt;</span>) segtree<span class="op">&lt;</span><span class="number">615</span>,<span class="number">614</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_alloc"><span class="tp">alloc</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>alloc: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
  <span class="kw">var</span> <a class="pp">leaf-count<span class="pc">leaf<span class="dash">-</span>count: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">405</span>,int<span class="op">&gt;</span></span></a> <span class="kw op">:=</span> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>
  <a class="pp" href="std_core_undiv-source.html#pretend_no_div">pretend-no-div<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>undiv<span class="fslash last">/</span></span>pretend<span class="dash">-</span>no<span class="dash">-</span>div: <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> ()) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a> {
    <a class="pp" href="std_core-source.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> bool, action <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> ()) <span class="kw op">-></span> <span class="op">&lt;</span>div,local<span class="op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a> { <a class="pp">leaf-count<span class="pc">leaf<span class="dash">-</span>count: <span class="tp">int</span><br>?hdiv=iev@438</span></a> <a class="pp" href="std_core_int-source.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,div,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> bool</span></a> <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> } { <a class="pp">leaf-count<span class="pc">leaf<span class="dash">-</span>count: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">405</span>,int<span class="op">&gt;</span></span></a> <a class="pp" href="std_core_types-source.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">405</span>,int<span class="op">&gt;</span>, assigned <span class="tp kw op">:</span> <span class="tp">int</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,div,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a> <a class="pp">leaf-count<span class="pc">leaf<span class="dash">-</span>count: <span class="tp">int</span><br>?hdiv=iev@504</span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,div,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> }
  }
  <a class="pp" href="#con_space_Segtree"><span class="co">Segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>Segtree: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">prod</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">leaf<span class="dash">-</span>count</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">mon</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(
    <a class="pp" href="std_core_types-source.html#ref">ref<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">394</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span>,local<span class="op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span><span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">395</span>,vector<span class="op">&lt;$</span><span class="number">394</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>(<a class="pp" href="std_core_vector-source.html#vector">vector<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>vector<span class="fslash last">/</span></span>vector: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">394</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">394</span><span class="op">&gt;</span></span></a>(<a class="pp">leaf-count<span class="pc">leaf<span class="dash">-</span>count: <span class="tp">int</span><br>?hdiv=iev@556</span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">mon<span class="pc">mon: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">394</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#monoid_fs_one">one<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>one: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">394</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">405</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">395</span><span class="op">&gt;</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">394</span></span></a>)),
    <a class="pp">leaf-count<span class="pc">leaf<span class="dash">-</span>count: <span class="tp">int</span><br>?hdiv=iev@581</span></a>,
    <a class="pp">mon<span class="pc">mon: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">394</span><span class="op">&gt;</span></span></a>
  </span>)

<span class="comment">// Get the &#96;k&#96;-th element.
// The first element is at position 0 (0-based).
</span><span class="kw">pub</span> <span class="kw">fun</span> @index(<span class="op">^</span><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">624</span>,<span class="op">$</span><span class="number">623</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <span class="op">^</span><a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">707</span><span class="op">&gt;</span>,div,exn<span class="op">&gt;</span> <span class="number">706</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a>
  (<a class="pp" href="std_core_types-source.html#ref_fs__excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span><span class="lq">ref<span class="fslash">/</span></span>(!): <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">624</span>,vector<span class="op">&lt;$</span><span class="number">623</span><span class="op">&gt;</span><span class="op">&gt;</span>, @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">624</span>,vector<span class="op">&lt;$</span><span class="number">623</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">624</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">623</span><span class="op">&gt;</span><br>?hdiv=iev@650</span></a><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">624</span>,<span class="op">$</span><span class="number">623</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">624</span>,<span class="op">$</span><span class="number">623</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">624</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">624</span>,vector<span class="op">&lt;$</span><span class="number">623</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)[<a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">624</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">624</span>,<span class="op">$</span><span class="number">623</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">624</span>,<span class="op">$</span><span class="number">623</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">624</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> int</span></a>]

<span class="comment">// TODO: is div removable?
</span><span class="kw">inline</span> <span class="decl-fun" id="recalc"><span class="kw">fun</span> <a class="pp" href="ck_segtree.html#recalc">recalc<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>recalc: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">k</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">729</span>,<span class="op">$</span><span class="number">728</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">971</span><span class="op">&gt;</span>,write<span class="op">&lt;</span><span class="number">971</span><span class="op">&gt;</span>,div,exn<span class="op">&gt;</span> ()</span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>write: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a>
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">729</span>,<span class="op">$</span><span class="number">728</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">729</span>,<span class="op">$</span><span class="number">728</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">729</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">729</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">729</span>,vector<span class="op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_types-source.html#modify">modify<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>modify: <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">729</span>,vector<span class="op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span><span class="op">&gt;</span>, f <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;</span>h<span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> (), @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">729</span>,vector<span class="op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">729</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">729</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ()<br>?hdiv=iev@734</span></a> <a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">prod</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;</span>h<span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>(<a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">757</span>,vector<span class="op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)
    <span class="decl-fun" id="loop"><span class="kw">fun</span> <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>
      <span class="kw">if</span> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_lt__eq_">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&lt;=): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span><span class="op">&gt;</span> bool</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a> <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="std_core_types-source.html#con_space_Unit"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Unit: <span class="tp sp">(</span><span class="tp sp">)</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Unit"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Unit: <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
      <span class="kw">val</span> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>
      <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">757</span>,vector<span class="op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>[<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>] <span class="kw op">:=</span> (<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">729</span>,<span class="op">$</span><span class="number">728</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_mon">mon<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>mon: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">729</span>,<span class="op">$</span><span class="number">728</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span><span class="op">&gt;</span> monoid<span class="op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span><span class="op">&gt;</span> ((<span class="op">$</span><span class="number">728</span>, <span class="op">$</span><span class="number">728</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">728</span>)</span></a>)(<a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span><br>?hdiv=iev@852</span></a>[<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>], <a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">728</span><span class="op">&gt;</span><br>?hdiv=iev@895</span></a>[<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>])
      <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(<a class="pp" href="std_core_undiv-source.html#pretend_decreasing">pretend-decreasing<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>undiv<span class="fslash last">/</span></span>pretend<span class="dash">-</span>decreasing: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)</span>)
    <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">757</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>(<a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a></span>)

<span class="comment">// Set a value to an element.
// The first element is at position 0 (0-based).
</span><span class="decl-fun" id="set"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#set">set<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">k</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">980</span>,<span class="op">$</span><span class="number">979</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">v<span class="pc">v: <span class="tp op">$</span><span class="number">979</span></span></a><span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">1078</span><span class="op">&gt;</span>,write<span class="op">&lt;</span><span class="number">1078</span><span class="op">&gt;</span>,div,exn<span class="op">&gt;</span> ()</span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>write: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a>
  <span class="kw">val</span> <a class="pp">k'<span class="pc">k': <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">980</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">980</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">980</span>,<span class="op">$</span><span class="number">979</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">980</span>,<span class="op">$</span><span class="number">979</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">980</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">980</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a>
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">980</span>,<span class="op">$</span><span class="number">979</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">980</span>,<span class="op">$</span><span class="number">979</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">980</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">980</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">980</span>,vector<span class="op">&lt;$</span><span class="number">979</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_types-source.html#modify">modify<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>modify: <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">980</span>,vector<span class="op">&lt;$</span><span class="number">979</span><span class="op">&gt;</span><span class="op">&gt;</span>, f <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">979</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;</span>h<span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> (), @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">980</span>,vector<span class="op">&lt;$</span><span class="number">979</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">980</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">980</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ()<br>?hdiv=iev@1002</span></a> <a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">prod</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">979</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;</span>h<span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>(<a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">1025</span>,vector<span class="op">&lt;$</span><span class="number">979</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>) { <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">1025</span>,vector<span class="op">&lt;$</span><span class="number">979</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>[<a class="pp">k'<span class="pc">k': <span class="tp">int</span></span></a>] <span class="kw op">:=</span> <a class="pp">v<span class="pc">v: <span class="tp op">$</span><span class="number">979</span></span></a> }
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">980</span>,<span class="op">$</span><span class="number">979</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#recalc">recalc<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>recalc: <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">980</span>,<span class="op">$</span><span class="number">979</span><span class="op">&gt;</span>, k <span class="tp kw op">:</span> <span class="tp">int</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">980</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">980</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">k'<span class="pc">k': <span class="tp">int</span></span></a></span>)

<span class="comment">// Apply a function to an element.
// The first element is at position 0 (0-based).
</span><span class="decl-fun" id="update"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#update">update<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>update: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">k</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h1</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h1</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1088</span>,<span class="op">$</span><span class="number">1086</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">f<span class="pc">f: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp op">$</span><span class="number">1086</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;</span>h<span class="op">&gt;</span>,div,exn<span class="op">|$</span><span class="number">1087</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">1086</span></span></a><span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><a class="pp"><span class="tp">h1</span><span class="pc">h1: <span class="co">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="std_core_types-source.html#type_space_local"><span class="tp">local</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h1</span><span class="pc">h1: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_effect_extend"><span class="tp"><span class="kw">|</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>effect<span class="dash">-</span>extend: <span class="tp sp">(</span><span class="co">X</span>, <span class="co">E</span>) <span class="kw op">-></span> <span class="co">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="co">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">1234</span><span class="op">&gt;</span>,write<span class="op">&lt;</span><span class="number">1234</span><span class="op">&gt;</span>,div,exn<span class="kw op">|</span><span class="number">1233</span><span class="op">&gt;</span> ()</span></a><span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>write: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_effect_extend"><span class="tp"><span class="kw">|</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>effect<span class="dash">-</span>extend: <span class="tp sp">(</span><span class="co">X</span>, <span class="co">E</span>) <span class="kw op">-></span> <span class="co">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="co">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a>
  <span class="comment">// TODO: make the type of &#96;f&#96; simple
</span>  <span class="kw">val</span> <a class="pp">k'<span class="pc">k': <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1088</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">1088</span><span class="op">&gt;|$</span><span class="number">1087</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1088</span>,<span class="op">$</span><span class="number">1086</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1088</span>,<span class="op">$</span><span class="number">1086</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1088</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">1088</span><span class="op">&gt;|$</span><span class="number">1087</span><span class="op">&gt;</span> int</span></a>
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1088</span>,<span class="op">$</span><span class="number">1086</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1088</span>,<span class="op">$</span><span class="number">1086</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1088</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">1088</span><span class="op">&gt;|$</span><span class="number">1087</span><span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">1088</span>,vector<span class="op">&lt;$</span><span class="number">1086</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_types-source.html#modify">modify<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>modify: <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">1088</span>,vector<span class="op">&lt;$</span><span class="number">1086</span><span class="op">&gt;</span><span class="op">&gt;</span>, f <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">1086</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;</span>h<span class="op">&gt;</span>,div,exn<span class="op">|$</span><span class="number">1087</span><span class="op">&gt;</span> (), @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">1088</span>,vector<span class="op">&lt;$</span><span class="number">1086</span><span class="op">&gt;</span>,<span class="op">&lt;</span>div,exn<span class="op">|$</span><span class="number">1087</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">1088</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">1088</span><span class="op">&gt;</span>,div,exn<span class="op">|$</span><span class="number">1087</span><span class="op">&gt;</span> ()<br>?hdiv=iev@1110</span></a> <a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">prod</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">1086</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,local<span class="op">&lt;</span>h<span class="op">&gt;|$</span><span class="number">1087</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">1133</span>,vector<span class="op">&lt;$</span><span class="number">1086</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)
    <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">1133</span>,vector<span class="op">&lt;$</span><span class="number">1086</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>[<a class="pp">k'<span class="pc">k': <span class="tp">int</span></span></a>] <span class="kw op">:=</span> <a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp op">$</span><span class="number">1086</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;$</span><span class="number">1133</span><span class="op">&gt;</span>,div,exn<span class="op">|$</span><span class="number">1087</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">1086</span></span></a>(<a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">1086</span><span class="op">&gt;</span><br>?hdiv=iev@1166</span></a>[<a class="pp">k'<span class="pc">k': <span class="tp">int</span></span></a>])
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1088</span>,<span class="op">$</span><span class="number">1086</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#recalc">recalc<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>recalc: <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1088</span>,<span class="op">$</span><span class="number">1086</span><span class="op">&gt;</span>, k <span class="tp kw op">:</span> <span class="tp">int</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1088</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">1088</span><span class="op">&gt;|$</span><span class="number">1087</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">k'<span class="pc">k': <span class="tp">int</span></span></a></span>)

<span class="comment">// Return the product from the &#96;left&#96;-th element (inclusive) to &#96;right&#96;-th element (exclusive).
// The first element is at position 0 (0-based).
</span><span class="decl-fun" id="product"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#product">product<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>product: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a>(<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">1723</span><span class="op">&gt;</span>,div,exn<span class="op">&gt;</span> <span class="number">1722</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a>
  <span class="decl-fun" id="loop"><span class="kw">fun</span> <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">1245</span>, pr <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">1245</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">1245</span></span></a>(<a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">1245</span></span></a>, <a class="pp">pr<span class="pc">pr: <span class="tp op">$</span><span class="number">1245</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> <span class="op">$</span><span class="number">1245</span></span></a>
    <span class="kw">if</span> <a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> bool</span></a> <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <span class="kw">then</span>
      <span class="kw">val</span> <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">l'<span class="pc">l': <span class="tp">int</span></span></a>, <a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">1245</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span>
        <span class="kw">if</span> <a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_gt_">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&gt;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> bool</span></a> <a class="pp">0<span class="pc">literal: <span class="tp">int</span><br>dec  = 0<br>hex8 = 0x00<br>bit8 = 0b00000000</span></a> <span class="kw">then</span>
          <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>, (<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_mon">mon<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>mon: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> monoid<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ((<span class="op">$</span><span class="number">1245</span>, <span class="op">$</span><span class="number">1245</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">1245</span>)</span></a>)(<a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">1245</span></span></a>, (<a class="pp" href="std_core_types-source.html#ref_fs__excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span><span class="lq">ref<span class="fslash">/</span></span>(!): <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">1246</span>,vector<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span><span class="op">&gt;</span>, @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">1246</span>,vector<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span><br>?hdiv=iev@1387</span></a><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">1246</span>,vector<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)[<a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a>])<a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
        <span class="kw">else</span>
          <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">1245</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
      <span class="kw">val</span> <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">r'<span class="pc">r': <span class="tp">int</span></span></a>, <a class="pp">pr'<span class="pc">pr': <span class="tp op">$</span><span class="number">1245</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span>
        <span class="kw">if</span> <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_gt_">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&gt;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> bool</span></a> <a class="pp">0<span class="pc">literal: <span class="tp">int</span><br>dec  = 0<br>hex8 = 0x00<br>bit8 = 0b00000000</span></a> <span class="kw">then</span>
          <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>, (<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_mon">mon<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>mon: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> monoid<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ((<span class="op">$</span><span class="number">1245</span>, <span class="op">$</span><span class="number">1245</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">1245</span>)</span></a>)((<a class="pp" href="std_core_types-source.html#ref_fs__excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span><span class="lq">ref<span class="fslash">/</span></span>(!): <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">1246</span>,vector<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span><span class="op">&gt;</span>, @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">1246</span>,vector<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span><br>?hdiv=iev@1537</span></a><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">1246</span>,vector<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)[<a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>], <a class="pp">pr<span class="pc">pr: <span class="tp op">$</span><span class="number">1245</span></span></a>)<a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
        <span class="kw">else</span>
          <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a>, <a class="pp">pr<span class="pc">pr: <span class="tp op">$</span><span class="number">1245</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
      <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">1245</span>, pr <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">1245</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> <span class="op">$</span><span class="number">1245</span></span></a>(<a class="pp">l'<span class="pc">l': <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">r'<span class="pc">r': <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">1245</span></span></a>, <a class="pp">pr'<span class="pc">pr': <span class="tp op">$</span><span class="number">1245</span></span></a>)
    <span class="kw">else</span>
      (<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_mon">mon<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>mon: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> monoid<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ((<span class="op">$</span><span class="number">1245</span>, <span class="op">$</span><span class="number">1245</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">1245</span>)</span></a>)(<a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">1245</span></span></a>, <a class="pp">pr<span class="pc">pr: <span class="tp op">$</span><span class="number">1245</span></span></a></span>)
  <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">1245</span>, pr <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">1245</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">1245</span></span></a>(
    <a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a>,
    <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a>,
    <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_mon">mon<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>mon: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span><span class="op">&gt;</span> monoid<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#monoid_fs_one">one<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>one: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">1245</span></span></a>,
    <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_mon">mon<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>mon: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1246</span>,<span class="op">$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span><span class="op">&gt;</span> monoid<span class="op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#monoid_fs_one">one<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>one: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1245</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1246</span><span class="op">&gt;</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">1245</span></span></a>
  </span>)

<span class="comment">// Return the largest integer &#96;k&#96; such that the product from the first element
// (inclusive) to the &#96;k&#96;-th element (exclusive) holds &#96;p&#96;.
// The first element is at position 0 (0-based).
// &#96;p&#96; must be decreasing and the product of the empty interval must hold &#96;p&#96;.
</span><span class="decl-fun" id="binsearch"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#binsearch">binsearch<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>binsearch: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h1</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h1</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp">int</span></span></a>(<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">p<span class="pc">p: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp op">$</span><span class="number">1731</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;</span>h<span class="op">&gt;</span>,div,exn<span class="op">|$</span><span class="number">1732</span><span class="op">&gt;</span> bool</span></a><span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><a class="pp"><span class="tp">h1</span><span class="pc">h1: <span class="co">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h1</span><span class="pc">h1: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_effect_extend"><span class="tp"><span class="kw">|</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>effect<span class="dash">-</span>extend: <span class="tp sp">(</span><span class="co">X</span>, <span class="co">E</span>) <span class="kw op">-></span> <span class="co">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="co">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core_types-source.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">2053</span><span class="op">&gt;</span>,div,exn<span class="kw op">|</span><span class="number">2052</span><span class="op">&gt;</span> int</span></a><span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_effect_extend"><span class="tp"><span class="kw">|</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>effect<span class="dash">-</span>extend: <span class="tp sp">(</span><span class="co">X</span>, <span class="co">E</span>) <span class="kw op">-></span> <span class="co">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="co">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>
  <span class="comment">// TODO: make the type of &#96;p&#96; simple
</span>  <span class="decl-fun" id="loop"><span class="kw">fun</span> <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">k</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">1731</span>, w <span class="tp kw op">:</span> <span class="tp">int</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a>(<a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a>, <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>, <a class="pp">v<span class="pc">v: <span class="tp op">$</span><span class="number">1731</span></span></a>, <a class="pp">w<span class="pc">w: <span class="tp">int</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a>
    <span class="kw">if</span> <a class="pp">w<span class="pc">w: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_eq__eq_">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(==): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> bool</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a> <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">int</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>
    <span class="kw">val</span> <a class="pp">v'<span class="pc">v': <span class="tp op">$</span><span class="number">1731</span></span></a> <span class="kw">=</span> (<a class="pp" href="std_core_types-source.html#ref_fs__excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span><span class="lq">ref<span class="fslash">/</span></span>(!): <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">1733</span>,vector<span class="op">&lt;$</span><span class="number">1731</span><span class="op">&gt;</span><span class="op">&gt;</span>, @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">1733</span>,vector<span class="op">&lt;$</span><span class="number">1731</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">|$</span><span class="number">1732</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;</span>,exn,div<span class="op">|$</span><span class="number">1732</span><span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">1731</span><span class="op">&gt;</span><br>?hdiv=iev@1868</span></a><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;</span>,exn,div<span class="op">|$</span><span class="number">1732</span><span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">1733</span>,vector<span class="op">&lt;$</span><span class="number">1731</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)[<a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1733</span><span class="op">&gt;</span>,exn,div<span class="op">|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>]
    <span class="kw">if</span> <a class="pp">p<span class="pc">p: <span class="tp sp">(</span><span class="tp op">$</span><span class="number">1731</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;</span>,div,exn<span class="op">|$</span><span class="number">1732</span><span class="op">&gt;</span> bool</span></a>((<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_mon">mon<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>mon: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> monoid<span class="op">&lt;$</span><span class="number">1731</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1731</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> ((<span class="op">$</span><span class="number">1731</span>, <span class="op">$</span><span class="number">1731</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">1731</span>)</span></a>)(<a class="pp">v<span class="pc">v: <span class="tp op">$</span><span class="number">1731</span></span></a>, <a class="pp">v'<span class="pc">v': <span class="tp op">$</span><span class="number">1731</span></span></a>)) <span class="kw">then</span>
      <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">k</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">1731</span>, w <span class="tp kw op">:</span> <span class="tp">int</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a>(<a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>, <a class="pp">v<span class="pc">v: <span class="tp op">$</span><span class="number">1731</span></span></a>, <a class="pp">w<span class="pc">w: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>)
    <span class="kw">else</span>
      <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">k</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">1731</span>, w <span class="tp kw op">:</span> <span class="tp">int</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a>(<a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>, <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a> <a class="pp">w<span class="pc">w: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, (<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_mon">mon<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>mon: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> monoid<span class="op">&lt;$</span><span class="number">1731</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1731</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> ((<span class="op">$</span><span class="number">1731</span>, <span class="op">$</span><span class="number">1731</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">1731</span>)</span></a>)(<a class="pp">v<span class="pc">v: <span class="tp op">$</span><span class="number">1731</span></span></a>, <a class="pp">v'<span class="pc">v': <span class="tp op">$</span><span class="number">1731</span></span></a>), <a class="pp">w<span class="pc">w: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a></span>)
  <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">k</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">1731</span>, w <span class="tp kw op">:</span> <span class="tp">int</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a>(<a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>, <a class="pp">0<span class="pc">literal: <span class="tp">int</span><br>dec  = 0<br>hex8 = 0x00<br>bit8 = 0b00000000</span></a>, <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_mon">mon<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>mon: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> monoid<span class="op">&lt;$</span><span class="number">1731</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#monoid_fs_one">one<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>one: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1731</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">1731</span></span></a>, <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1733</span>,<span class="op">$</span><span class="number">1731</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">1733</span><span class="op">&gt;|$</span><span class="number">1732</span><span class="op">&gt;</span> int</span></a></span>)

<span class="decl-fun" id="int_add_monoid"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#int_add_monoid">int-add-monoid<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>int<span class="dash">-</span>add<span class="dash">-</span>monoid: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
  <a class="pp" href="#con_space_Monoid"><span class="co">Monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>Monoid: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">one</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">mul</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">0<span class="pc">literal: <span class="tp">int</span><br>dec  = 0<br>hex8 = 0x00<br>bit8 = 0b00000000</span></a>, <a class="pp" href="std_core_int-source.html#_plus_">(+)<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a></span>)
</pre>

</body>
</html>
