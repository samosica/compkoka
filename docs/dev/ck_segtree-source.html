<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="initial-scale=1.0" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Nunito:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>segtree.kk documentation</title>
</head>

<body class="koka doc body madoko">
<pre class="koka source"><span class="comment">/&#42; Segment tree

Segment tree is a data structure for efficient range operations on sequences.

Notes:

- A binary operation to be used may be a partial function as long as it can be
  applied to any consecutive elements in a sequence. Hence &#96;segtree&#96; can handle
  matrix production and range union.

Usage:

&#96;&#96;&#96;
import ck/algebra/monoid
import ck/segtree

fun main()
  val seg = segtree(10, ?monoid=int/add/monoid)

  seg.set(1, 3, ?monoid=int/add/monoid)
  seg.set(3, 8, ?monoid=int/add/monoid)
  seg.product(0, 10, ?monoid=int/add/monoid).println // 11
&#96;&#96;&#96;
\/
&#42;/</span>
<span class="kw">module</span> <a class="pp" href="ck_segtree.html#_null_"><span class="mo">ck/segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree</span></span></a>

<span class="kw">import</span> <a class="pp" href="std_core_int.html#_null_"><span class="mo">std/core/int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int</span></span></a>
<span class="kw">import</span> <a class="pp" href="std_core_undiv.html#_null_"><span class="mo">std/core/undiv</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>undiv</span></span></a>
<span class="kw">import</span> <a class="pp" href="ck_algebra_monoid.html#_null_"><span class="mo">ck/algebra/monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid</span></span></a>

<span class="decl-value type" id="type_space_segtree"><span class="kw">abstract</span> <span class="kw">value</span> <span class="tp kw">struct</span> <span class="decl-con" id="con_space_Segtree"><a class="pp" href="ck_segtree.html#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
  <a class="pp" href="ck_segtree.html#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_ref"><span class="tp">ref</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_vector"><span class="tp">vector</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>vector: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span>
  <a class="pp" href="ck_segtree.html#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a></span></span>

<span class="decl-fun" id="floor_log"><span class="kw">fun</span> <a class="pp" href="ck_segtree.html#floor_log">floor-log<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>floor<span class="dash">-</span>log: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">base</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>
  <span class="kw">if</span> <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <span class="kw">then</span>
    <a class="pp">0<span class="pc">literal: <span class="tp">int</span><br>dec  = 0<br>hex8 = 0x00<br>bit8 = 0b00000000</span></a>
  <span class="kw">else</span>
    <a class="pp" href="#floor_log">floor-log<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>floor<span class="dash">-</span>log: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">base</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>((<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_core_undiv-source.html#pretend_decreasing">pretend-decreasing<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>undiv<span class="fslash last">/</span></span>pretend<span class="dash">-</span>decreasing: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a>) <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> </span><a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>

<span class="comment">// Create a segment tree
</span><span class="decl-fun" id="segtree"><span class="kw">pub</span> <span class="kw">inline</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#segtree">segtree<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">387</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="ck_algebra_monoid-source.html#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="number">444</span><span class="op">&gt;</span>) segtree<span class="op">&lt;</span><span class="number">444</span>,<span class="number">443</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_alloc"><span class="tp">alloc</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>alloc: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
  <a class="pp" href="#con_space_Segtree"><span class="co">Segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>Segtree: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">prod</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">leaf<span class="dash">-</span>count</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(
    <a class="pp" href="std_core_types-source.html#ref">ref<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">387</span><span class="op">&gt;</span>) <span class="kw op">-></span> (alloc<span class="op">&lt;$</span><span class="number">388</span><span class="op">&gt;</span>) ref<span class="op">&lt;$</span><span class="number">388</span>,vector<span class="op">&lt;$</span><span class="number">387</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>(<a class="pp" href="std_core_vector-source.html#vector">vector<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>vector<span class="fslash last">/</span></span>vector: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">387</span>) <span class="kw op">-></span> (alloc<span class="op">&lt;$</span><span class="number">388</span><span class="op">&gt;</span>) vector<span class="op">&lt;$</span><span class="number">387</span><span class="op">&gt;</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp op">&lt;$</span><span class="number">388</span><span class="op">&gt;</span>) int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">387</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_one">one<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>one: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">387</span><span class="op">&gt;</span>) <span class="kw op">-></span> (alloc<span class="op">&lt;$</span><span class="number">388</span><span class="op">&gt;</span>) <span class="op">$</span><span class="number">387</span></span></a>)),
    <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>
  </span>)

<span class="comment">// Note: &#96;@unsafe-vector&#96; is introduced in Koka v3.1.3.
</span>
<span class="comment">// Unsafe function.
// This function is an internal function in the standard library.
// See &lt;https://koka-lang.github.io/koka/doc/std&#95;core&#95;vector.html&gt;
</span>inline <span class="decl-extern" id="unsafe_vector"><span class="kw">extern</span> <a class="pp" href="ck_segtree.html#unsafe_vector">unsafe-vector<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>unsafe<span class="dash">-</span>vector: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">ssize&#95;t</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(n<span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_ssize__t"><span class="tp">ssize&#95;t</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ssize&#95;t: <span class="co">V</span></span></a>)<span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">total</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a> <a class="pp" href="std_core_types-source.html#type_space_vector"><span class="tp">vector</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>vector: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
  c inline <span class="st">"kk&#95;vector&#95;alloc(#1, kk&#95;box&#95;null(), kk&#95;context())"</span></span>

<span class="decl-fun" id="list_fs_segtree"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#list_fs_segtree">list/segtree<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">list<span class="fslash">/</span></span>segtree: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">l<span class="pc">l: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>list: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="ck_algebra_monoid-source.html#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="number">928</span><span class="op">&gt;</span>,div,exn<span class="op">&gt;</span> segtree<span class="op">&lt;</span><span class="number">928</span>,<span class="number">927</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><a class="pp" href="std_core_types-source.html#type_space_alloc"><span class="tp">alloc</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>alloc: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
  <span class="kw">val</span> <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">l<span class="pc">l: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_list-source.html#length">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>list<span class="fslash last">/</span></span>length: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>alloc<span class="op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,exn,local<span class="op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a>
  <span class="kw">var</span> <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">568</span>,vector<span class="op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a> <span class="kw op">:=</span> <a class="pp" href="#unsafe_vector">unsafe-vector<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>unsafe<span class="dash">-</span>vector: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">ssize&#95;t</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">alloc</span><span class="tp op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,exn,local<span class="op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span></span></a>((<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">alloc</span><span class="tp op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,exn,local<span class="op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>)<span class="kw op">.</span><a class="pp" href="std_core_int-source.html#ssize__t">ssize&#95;t<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>ssize&#95;t: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">alloc</span><span class="tp op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,exn,local<span class="op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ssize&#95;t</span></a>)
  <a class="pp">l<span class="pc">l: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_list-source.html#foreach_indexed">foreach-indexed<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>list<span class="fslash last">/</span></span>foreach<span class="dash">-</span>indexed: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span>, action <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp op">$</span><span class="number">557</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ()) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a> <a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">557</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>, <a class="pp">v<span class="pc">v: <span class="tp op">$</span><span class="number">557</span></span></a>)
    <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">568</span>,vector<span class="op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>] <span class="kw op">:=</span> <a class="pp">v<span class="pc">v: <span class="tp op">$</span><span class="number">557</span></span></a>
  <span class="kw">inline</span> <span class="decl-fun" id="loop"><span class="kw">fun</span> <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>
    <span class="kw">if</span> <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_lt__eq_">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&lt;=): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> bool</span></a> <a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a> <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="std_core_types-source.html#con_space_Unit"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Unit: <span class="tp sp">(</span><span class="tp sp">)</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Unit"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Unit: <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
    <a class="pp" href="std_core-source.html#range_fs_for">for<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span><span class="lq">range<span class="fslash">/</span></span>for: <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> ()) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a>, <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>) <a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>)
      <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">568</span>,vector<span class="op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>] <span class="kw op">:=</span> (<a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> ((<span class="op">$</span><span class="number">557</span>, <span class="op">$</span><span class="number">557</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">557</span>)</span></a>)(<a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span><br>?hdiv=iev@742</span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>], <a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span><br>?hdiv=iev@785</span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>])
    <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(((<a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>) <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>)<span class="kw op">.</span><a class="pp" href="std_core_undiv-source.html#pretend_decreasing">pretend-decreasing<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>undiv<span class="fslash last">/</span></span>pretend<span class="dash">-</span>decreasing: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a>, <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a></span>)
  <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>((<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>) <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>)
  <a class="pp" href="#con_space_Segtree"><span class="co">Segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>Segtree: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">prod</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">leaf<span class="dash">-</span>count</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="std_core_types-source.html#ref">ref<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>alloc<span class="op">&lt;$</span><span class="number">558</span><span class="op">&gt;</span>,local<span class="op">&lt;$</span><span class="number">568</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">558</span>,vector<span class="op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>(<a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">557</span><span class="op">&gt;</span><br>?hdiv=iev@890</span></a>), <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a></span>)

<span class="decl-fun" id="vector_fs_segtree"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#vector_fs_segtree">vector/segtree<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">vector<span class="fslash">/</span></span>segtree: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">v<span class="pc">v: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_vector"><span class="tp">vector</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>vector: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="ck_algebra_monoid-source.html#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="number">1321</span><span class="op">&gt;</span>,div,exn<span class="op">&gt;</span> segtree<span class="op">&lt;</span><span class="number">1321</span>,<span class="number">1320</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><a class="pp" href="std_core_types-source.html#type_space_alloc"><span class="tp">alloc</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>alloc: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
  <span class="kw">val</span> <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">v<span class="pc">v: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_vector-source.html#length">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>vector<span class="fslash last">/</span></span>length: <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>alloc<span class="op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,exn,local<span class="op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a>
  <span class="kw">var</span> <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">947</span>,vector<span class="op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a> <span class="kw op">:=</span> <a class="pp" href="#unsafe_vector">unsafe-vector<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>unsafe<span class="dash">-</span>vector: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">ssize&#95;t</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">alloc</span><span class="tp op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,exn,local<span class="op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span></span></a>((<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">alloc</span><span class="tp op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,exn,local<span class="op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>)<span class="kw op">.</span><a class="pp" href="std_core_int-source.html#ssize__t">ssize&#95;t<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>ssize&#95;t: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">alloc</span><span class="tp op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,exn,local<span class="op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ssize&#95;t</span></a>)
  <a class="pp" href="std_core-source.html#for">for<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>for: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ()) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) <a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>)
    <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">947</span>,vector<span class="op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>] <span class="kw op">:=</span> <a class="pp">v<span class="pc">v: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span></span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>]
  <span class="kw">inline</span> <span class="decl-fun" id="loop"><span class="kw">fun</span> <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>
    <span class="kw">if</span> <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_lt__eq_">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&lt;=): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> bool</span></a> <a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a> <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="std_core_types-source.html#con_space_Unit"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Unit: <span class="tp sp">(</span><span class="tp sp">)</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Unit"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Unit: <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
    <a class="pp" href="std_core-source.html#range_fs_for">for<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span><span class="lq">range<span class="fslash">/</span></span>for: <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> ()) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a>, <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>) <a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>)
      <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">947</span>,vector<span class="op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>] <span class="kw op">:=</span> (<a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> ((<span class="op">$</span><span class="number">936</span>, <span class="op">$</span><span class="number">936</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">936</span>)</span></a>)(<a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span><br>?hdiv=iev@1135</span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>], <a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span><br>?hdiv=iev@1178</span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>])
    <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(((<a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>) <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>)<span class="kw op">.</span><a class="pp" href="std_core_undiv-source.html#pretend_decreasing">pretend-decreasing<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>undiv<span class="fslash last">/</span></span>pretend<span class="dash">-</span>decreasing: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a>, <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a></span>)
  <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>((<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>) <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,alloc<span class="op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>)
  <a class="pp" href="#con_space_Segtree"><span class="co">Segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>Segtree: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">prod</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">leaf<span class="dash">-</span>count</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="std_core_types-source.html#ref">ref<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>alloc<span class="op">&lt;$</span><span class="number">937</span><span class="op">&gt;</span>,local<span class="op">&lt;$</span><span class="number">947</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">937</span>,vector<span class="op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>(<a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">936</span><span class="op">&gt;</span><br>?hdiv=iev@1283</span></a>), <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a></span>)

<span class="comment">// Get the &#96;k&#96;-th element.
// The first element is at position 0 (0-based).
</span><span class="kw">pub</span> <span class="kw">inline</span> <span class="kw">fun</span> @index(<span class="op">^</span><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">453</span>,<span class="op">$</span><span class="number">452</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <span class="op">^</span><a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">536</span><span class="op">&gt;</span>,div,exn<span class="op">&gt;</span> <span class="number">535</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a>
  (<a class="pp" href="std_core_types-source.html#ref_fs__excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span><span class="lq">ref<span class="fslash">/</span></span>(!): <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">453</span>,vector<span class="op">&lt;$</span><span class="number">452</span><span class="op">&gt;</span><span class="op">&gt;</span>, @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">453</span>,vector<span class="op">&lt;$</span><span class="number">452</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">453</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">452</span><span class="op">&gt;</span><br>?hdiv=iev@479</span></a><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">453</span>,<span class="op">$</span><span class="number">452</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">453</span>,<span class="op">$</span><span class="number">452</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">453</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">453</span>,vector<span class="op">&lt;$</span><span class="number">452</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)[<a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">453</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">453</span>,<span class="op">$</span><span class="number">452</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">453</span>,<span class="op">$</span><span class="number">452</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">453</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> int</span></a>]

<span class="kw">inline</span> <span class="decl-fun" id="recalc"><span class="kw">fun</span> <a class="pp" href="ck_segtree.html#recalc">recalc<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>recalc: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">k</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1330</span>,<span class="op">$</span><span class="number">1329</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="ck_algebra_monoid-source.html#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">2153</span><span class="op">&gt;</span>,write<span class="op">&lt;</span><span class="number">2153</span><span class="op">&gt;</span>,div,exn<span class="op">&gt;</span> ()</span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>write: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a>
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1330</span>,<span class="op">$</span><span class="number">1329</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1330</span>,<span class="op">$</span><span class="number">1329</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">1330</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">1330</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">1330</span>,vector<span class="op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_types-source.html#modify">modify<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>modify: <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">1330</span>,vector<span class="op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span><span class="op">&gt;</span>, f <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;</span>h<span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> (), @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">1330</span>,vector<span class="op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">1330</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">1330</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ()<br>?hdiv=iev@1335</span></a> <a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">prod</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;</span>h<span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>(<a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">1358</span>,vector<span class="op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)
    <span class="kw">inline</span> <span class="decl-fun" id="loop"><span class="kw">fun</span> <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">invalid<span class="dash">-</span>start</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">invalid-start<span class="pc">invalid<span class="dash">-</span>start: <span class="tp">bool</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="co">V</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>
      <span class="kw">if</span> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_eq__eq_">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(==): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> bool</span></a> <a class="pp">0<span class="pc">literal: <span class="tp">int</span><br>dec  = 0<br>hex8 = 0x00<br>bit8 = 0b00000000</span></a> <a class="pp" href="std_core_types-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> bool</span></a> <a class="pp">invalid-start<span class="pc">invalid<span class="dash">-</span>start: <span class="tp">bool</span></span></a> <a class="pp" href="std_core_types-source.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> bool</span></a> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_eq__eq_">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(==): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> bool</span></a> <a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <span class="kw">then</span>
        <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="std_core_types-source.html#con_space_Unit"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Unit: <span class="tp sp">(</span><span class="tp sp">)</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Unit"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Unit: <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
      <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">1358</span>,vector<span class="op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>] <span class="kw op">:=</span> (<a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> ((<span class="op">$</span><span class="number">1329</span>, <span class="op">$</span><span class="number">1329</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">1329</span>)</span></a>)(<a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span><br>?hdiv=iev@1662</span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>], <a class="pp">prod<span class="pc">prod: <span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">1329</span><span class="op">&gt;</span><br>?hdiv=iev@1705</span></a>[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,exn<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>])
      <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">invalid<span class="dash">-</span>start</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> ()</span></a>((<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>)<span class="kw op">.</span><a class="pp" href="std_core_undiv-source.html#pretend_decreasing">pretend-decreasing<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>undiv<span class="fslash last">/</span></span>pretend<span class="dash">-</span>decreasing: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a>, <a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">invalid-start<span class="pc">invalid<span class="dash">-</span>start: <span class="tp">bool</span></span></a> <a class="pp" href="std_core_types-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> bool</span></a> <a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_eq__eq_">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(==): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span><span class="op">&gt;</span> bool</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a></span>)
    <span class="kw">val</span> <a class="pp">s<span class="pc">s: <span class="tp">int</span></span></a> <span class="kw">=</span>
      <span class="kw">if</span> <a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_gt__eq_">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&gt;=): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> bool</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1330</span>,<span class="op">$</span><span class="number">1329</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1330</span>,<span class="op">$</span><span class="number">1329</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a><span class="kw op">.</span><a class="pp" href="#floor_log">floor-log<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>floor<span class="dash">-</span>log: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">base</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a>(<a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>)<span class="kw op">.</span><a class="pp" href="std_core_int-source.html#inc">inc<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>inc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a><span class="kw op">.</span><a class="pp" href="std_core_int-source.html#exp2">exp2<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>exp2: <span class="tp sp">(</span><span class="tp tpp">exp</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <span class="kw">then</span>
        <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1330</span>,<span class="op">$</span><span class="number">1329</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1330</span>,<span class="op">$</span><span class="number">1329</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>
      <span class="kw">else</span>
        <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1330</span>,<span class="op">$</span><span class="number">1329</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">1330</span>,<span class="op">$</span><span class="number">1329</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a>
    <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">invalid<span class="dash">-</span>start</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>(<a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">s<span class="pc">s: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">s<span class="pc">s: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_eq__eq_">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(==): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">local</span><span class="tp op">&lt;$</span><span class="number">1358</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> bool</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a></span>)

<span class="comment">// Set a value to an element.
// The first element is at position 0 (0-based).
</span><span class="decl-fun" id="set"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#set">set<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">k</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2162</span>,<span class="op">$</span><span class="number">2161</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">v<span class="pc">v: <span class="tp op">$</span><span class="number">2161</span></span></a><span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a>, <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2161</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="ck_algebra_monoid-source.html#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">2320</span><span class="op">&gt;</span>,write<span class="op">&lt;</span><span class="number">2320</span><span class="op">&gt;</span>,div,exn<span class="op">&gt;</span> ()</span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>write: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a>
  <span class="kw">val</span> <a class="pp">k'<span class="pc">k': <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2162</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">2162</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2162</span>,<span class="op">$</span><span class="number">2161</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2162</span>,<span class="op">$</span><span class="number">2161</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2162</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">2162</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a>
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2162</span>,<span class="op">$</span><span class="number">2161</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2162</span>,<span class="op">$</span><span class="number">2161</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">2162</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">2162</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">2162</span>,vector<span class="op">&lt;$</span><span class="number">2161</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_types-source.html#modify">modify<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>modify: <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">2162</span>,vector<span class="op">&lt;$</span><span class="number">2161</span><span class="op">&gt;</span><span class="op">&gt;</span>, f <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">2161</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>local<span class="op">&lt;</span>h<span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> (), @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">2162</span>,vector<span class="op">&lt;$</span><span class="number">2161</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2162</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">2162</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ()<br>?hdiv=iev@2184</span></a> <a class="pp"><span class="kw">fn</span><span class="pc">fn: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">prod</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp">vector</span><span class="tp op">&lt;$</span><span class="number">2161</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,local<span class="op">&lt;</span>h<span class="op">&gt;</span>,div<span class="op">&gt;</span> ()</span></a>(<a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">2207</span>,vector<span class="op">&lt;$</span><span class="number">2161</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>) { <a class="pp">prod<span class="pc">prod: <span class="tp">local<span class="dash">-</span>var</span><span class="tp op">&lt;$</span><span class="number">2207</span>,vector<span class="op">&lt;$</span><span class="number">2161</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>[<a class="pp">k'<span class="pc">k': <span class="tp">int</span></span></a>] <span class="kw op">:=</span> <a class="pp">v<span class="pc">v: <span class="tp op">$</span><span class="number">2161</span></span></a> }
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2162</span>,<span class="op">$</span><span class="number">2161</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#recalc">recalc<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>recalc: <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2162</span>,<span class="op">$</span><span class="number">2161</span><span class="op">&gt;</span>, k <span class="tp kw op">:</span> <span class="tp">int</span>, @implicit<span class="fslash">/</span>monoid <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2161</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2162</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">2162</span><span class="op">&gt;</span><span class="op">&gt;</span> ()<br>?monoid=?monoid</span></a>(<a class="pp">k'<span class="pc">k': <span class="tp">int</span></span></a></span>)

<span class="comment">// Apply a function to an element.
// The first element is at position 0 (0-based).
</span><span class="decl-fun" id="update"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#update">update<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>update: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">k</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h1</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h1</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h1</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2330</span>,<span class="op">$</span><span class="number">2328</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>,
  <a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>,
  <a class="pp">f<span class="pc">f: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp op">$</span><span class="number">2328</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;</span>h<span class="op">&gt;</span>,write<span class="op">&lt;</span>h<span class="op">&gt;</span>,div,exn<span class="op">|$</span><span class="number">2329</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">2328</span></span></a><span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><a class="pp"><span class="tp">h1</span><span class="pc">h1: <span class="co">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h1</span><span class="pc">h1: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>write: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h1</span><span class="pc">h1: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_effect_extend"><span class="tp"><span class="kw">|</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>effect<span class="dash">-</span>extend: <span class="tp sp">(</span><span class="co">X</span>, <span class="co">E</span>) <span class="kw op">-></span> <span class="co">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="co">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a>,
  <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2328</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="ck_algebra_monoid-source.html#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
<a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">2455</span><span class="op">&gt;</span>,write<span class="op">&lt;</span><span class="number">2455</span><span class="op">&gt;</span>,div,exn<span class="kw op">|</span><span class="number">2454</span><span class="op">&gt;</span> ()</span></a><span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>write: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_effect_extend"><span class="tp"><span class="kw">|</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>effect<span class="dash">-</span>extend: <span class="tp sp">(</span><span class="co">X</span>, <span class="co">E</span>) <span class="kw op">-></span> <span class="co">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="co">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a><a class="pp" href="std_core_types-source.html#type_space_unit"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>unit: <span class="co">V</span></span></a>
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2330</span>,<span class="op">$</span><span class="number">2328</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#set">set<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>set: <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2330</span>,<span class="op">$</span><span class="number">2328</span><span class="op">&gt;</span>, k <span class="tp kw op">:</span> <span class="tp">int</span>, v <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2328</span>, @implicit<span class="fslash">/</span>monoid <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2328</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2330</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">2330</span><span class="op">&gt;|$</span><span class="number">2329</span><span class="op">&gt;</span> ()<br>?monoid=?monoid</span></a>(<a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a>, <a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp op">$</span><span class="number">2328</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2330</span><span class="op">&gt;</span>,write<span class="op">&lt;$</span><span class="number">2330</span><span class="op">&gt;</span>,div,exn<span class="op">|$</span><span class="number">2329</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">2328</span></span></a>(<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2330</span>,<span class="op">$</span><span class="number">2328</span><span class="op">&gt;</span></span></a>[<a class="pp">k<span class="pc">k: <span class="tp">int</span></span></a>])</span>)

<span class="comment">// Return the product from the &#96;left&#96;-th element (inclusive) to &#96;right&#96;-th element (exclusive).
// The first element is at position 0 (0-based).
</span><span class="decl-fun" id="product"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#product">product<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>product: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">left</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">right</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a>(<a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2467</span>,<span class="op">$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="ck_algebra_monoid-source.html#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">2894</span><span class="op">&gt;</span>,div,exn<span class="op">&gt;</span> <span class="number">2893</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_total"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>total: <span class="co">E</span></span></a><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="co">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_exn-source.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>exn<span class="fslash last">/</span></span>exn: <span class="tp sp">(</span><span class="co">E</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a>
  <span class="kw">inline</span> <span class="decl-fun" id="loop"><span class="kw">fun</span> <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2466</span>, pr <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2466</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">2466</span></span></a>(<a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2466</span></span></a>, <a class="pp">pr<span class="pc">pr: <span class="tp op">$</span><span class="number">2466</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> <span class="op">$</span><span class="number">2466</span></span></a>
    <span class="kw">if</span> <a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> bool</span></a> <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <span class="kw">then</span>
      <span class="kw">val</span> <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">l'<span class="pc">l': <span class="tp">int</span></span></a>, <a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2466</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span>
        <span class="kw">if</span> <a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_gt_">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&gt;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> bool</span></a> <a class="pp">0<span class="pc">literal: <span class="tp">int</span><br>dec  = 0<br>hex8 = 0x00<br>bit8 = 0b00000000</span></a> <span class="kw">then</span>
          <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>, (<a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ((<span class="op">$</span><span class="number">2466</span>, <span class="op">$</span><span class="number">2466</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">2466</span>)</span></a>)(<a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2466</span></span></a>, (<a class="pp" href="std_core_types-source.html#ref_fs__excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span><span class="lq">ref<span class="fslash">/</span></span>(!): <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">2467</span>,vector<span class="op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span><span class="op">&gt;</span>, @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">2467</span>,vector<span class="op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span><br>?hdiv=iev@2598</span></a><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2467</span>,<span class="op">$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2467</span>,<span class="op">$</span><span class="number">2466</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">2467</span>,vector<span class="op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)[<a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a>])<a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
        <span class="kw">else</span>
          <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2466</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
      <span class="kw">val</span> <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">r'<span class="pc">r': <span class="tp">int</span></span></a>, <a class="pp">pr'<span class="pc">pr': <span class="tp op">$</span><span class="number">2466</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span>
        <span class="kw">if</span> <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_gt_">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&gt;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> bool</span></a> <a class="pp">0<span class="pc">literal: <span class="tp">int</span><br>dec  = 0<br>hex8 = 0x00<br>bit8 = 0b00000000</span></a> <span class="kw">then</span>
          <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>, (<a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ((<span class="op">$</span><span class="number">2466</span>, <span class="op">$</span><span class="number">2466</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">2466</span>)</span></a>)((<a class="pp" href="std_core_types-source.html#ref_fs__excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span><span class="lq">ref<span class="fslash">/</span></span>(!): <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">2467</span>,vector<span class="op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span><span class="op">&gt;</span>, @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">2467</span>,vector<span class="op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span><br>?hdiv=iev@2738</span></a><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2467</span>,<span class="op">$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2467</span>,<span class="op">$</span><span class="number">2466</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">2467</span>,vector<span class="op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)[<a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,exn,div<span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>], <a class="pp">pr<span class="pc">pr: <span class="tp op">$</span><span class="number">2466</span></span></a>)<a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
        <span class="kw">else</span>
          <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a>, <a class="pp">pr<span class="pc">pr: <span class="tp op">$</span><span class="number">2466</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
      <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2466</span>, pr <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2466</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> <span class="op">$</span><span class="number">2466</span></span></a>(<a class="pp">l'<span class="pc">l': <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">r'<span class="pc">r': <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2466</span></span></a>, <a class="pp">pr'<span class="pc">pr': <span class="tp op">$</span><span class="number">2466</span></span></a>)
    <span class="kw">else</span>
      (<a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span>,div<span class="op">&gt;</span> ((<span class="op">$</span><span class="number">2466</span>, <span class="op">$</span><span class="number">2466</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">2466</span>)</span></a>)(<a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2466</span></span></a>, <a class="pp">pr<span class="pc">pr: <span class="tp op">$</span><span class="number">2466</span></span></a></span>)
  <a class="pp">loop<span class="pc">loop: <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2466</span>, pr <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2466</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">2466</span></span></a>(
    <a class="pp">left<span class="pc">left: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2467</span>,<span class="op">$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2467</span>,<span class="op">$</span><span class="number">2466</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a>,
    <a class="pp">right<span class="pc">right: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2467</span>,<span class="op">$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2467</span>,<span class="op">$</span><span class="number">2466</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span><span class="op">&gt;</span> int</span></a>,
    <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_one">one<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>one: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">2466</span></span></a>,
    <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_one">one<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>one: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2466</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2467</span><span class="op">&gt;</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">2466</span></span></a>
  </span>)

<span class="comment">// Return the smallest integer &#96;k&#96; between &#96;start&#96; (inclusive) and &#96;end&#96; (exclusive)
// such that the product from the &#96;start&#96;-th element (inclusive) to the &#96;k&#96;-th
// element (inclusive) holds &#96;p&#96;. If no such &#96;k&#96; exists, return &#96;end&#96;.
// The first element is at position 0 (0-based).
// &#96;p&#96; must be increasing.
</span><span class="decl-fun" id="binsearch"><span class="kw">pub</span> <span class="kw">fun</span> <a class="pp" href="ck_segtree.html#binsearch">binsearch<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>binsearch: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">seg</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h1</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">pure</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h1</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">@implicit<span class="fslash">/</span>monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">pure</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp">int</span></span></a>(
  <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="#type_space_segtree"><span class="tp">segtree</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span>segtree: <span class="tp sp">(</span><span class="co">H</span>, <span class="co">V</span>) <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">,</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>,
  <a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>,
  <a class="pp">end<span class="pc">end: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>,
  <a class="pp">p<span class="pc">p: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;</span>h<span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a><span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><a class="pp"><span class="tp">h1</span><span class="pc">h1: <span class="co">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="std_core-source.html#type_space_pure"><span class="tp"><span class="effect">pure</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="co">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h1</span><span class="pc">h1: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><a class="pp" href="std_core_types-source.html#type_space_effect_extend"><span class="tp"><span class="kw">|</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>effect<span class="dash">-</span>extend: <span class="tp sp">(</span><span class="co">X</span>, <span class="co">E</span>) <span class="kw op">-></span> <span class="co">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="co">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core_types-source.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="co">V</span></span></a>,
  <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="ck_algebra_monoid-source.html#type_space_monoid"><span class="tp">monoid</span><span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span>monoid: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>
<a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">pure</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="number">3902</span><span class="op">&gt;</span><span class="kw op">|</span><span class="number">3901</span><span class="op">&gt;</span> int</span></a><span class="tp kw op">:</span> <span class="tp sp">&lt;</span><a class="pp" href="std_core-source.html#type_space_pure"><span class="tp"><span class="effect">pure</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="co">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core_types-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="co">H</span> <span class="kw op">-></span> <span class="co">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="co">H</span></span></a><span class="tp sp">&gt;</span><a class="pp" href="std_core_types-source.html#type_space_effect_extend"><span class="tp"><span class="kw">|</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>effect<span class="dash">-</span>extend: <span class="tp sp">(</span><span class="co">X</span>, <span class="co">E</span>) <span class="kw op">-></span> <span class="co">E</span></span></a><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="co">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>
  <span class="kw">inline</span> <span class="decl-fun" id="extend"><span class="kw">fun</span> <a class="pp">extend<span class="pc">extend: <span class="tp sp">(</span><span class="tp tpp">rs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> (int, <span class="op">$</span><span class="number">2902</span>)</span></a>(<a class="pp">rs<span class="pc">rs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>list: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> (int, <span class="op">$</span><span class="number">2902</span>)</span></a>
    <span class="kw">match</span> <a class="pp">rs<span class="pc">rs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>
      <a class="pp" href="std_core_types-source.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">end<span class="pc">end: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
      <a class="pp" href="std_core_types-source.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a>, <a class="pp">rs'<span class="pc">rs': <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>) <span class="kw op">-></span>
        <span class="kw">val</span> <a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2902</span></span></a> <span class="kw">=</span> (<a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> ((<span class="op">$</span><span class="number">2902</span>, <span class="op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">2902</span>)</span></a>)(<a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a>, (<a class="pp" href="std_core_types-source.html#ref_fs__excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span><span class="lq">ref<span class="fslash">/</span></span>(!): <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">2904</span>,vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span><span class="op">&gt;</span>, @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">2904</span>,vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,exn,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span><br>?hdiv=iev@2978</span></a><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,exn,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">2904</span>,vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)[<a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a>])
        <span class="kw">if</span> <a class="pp">p<span class="pc">p: <span class="tp sp">(</span><span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a>(<a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2902</span></span></a>) <span class="kw">then</span> <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">else</span> <a class="pp">extend<span class="pc">extend: <span class="tp sp">(</span><span class="tp tpp">rs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> (int, <span class="op">$</span><span class="number">2902</span>)</span></a>(<a class="pp">rs'<span class="pc">rs': <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>, <a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2902</span></span></a></span>)
  <span class="kw">inline</span> <span class="decl-fun" id="big_step"><span class="kw">fun</span> <a class="pp">big-step<span class="pc">big<span class="dash">-</span>step: <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">rs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> (int, <span class="op">$</span><span class="number">2902</span>)</span></a>(<a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">rs<span class="pc">rs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>list: <span class="co">V</span> <span class="kw op">-></span> <span class="co">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> (int, <span class="op">$</span><span class="number">2902</span>)</span></a>
    <span class="kw">if</span> <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_lt__eq_">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&lt;=): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a> <a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp op">$</span><span class="number">2902</span>)</span></a> <a class="pp">extend<span class="pc">extend: <span class="tp sp">(</span><span class="tp tpp">rs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> (int, <span class="op">$</span><span class="number">2902</span>)</span></a>(<a class="pp">rs<span class="pc">rs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Unit"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Unit: <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
    <span class="kw">val</span> <a class="pp">l'<span class="pc">l': <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>) <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>
    <span class="kw">val</span> <a class="pp">r'<span class="pc">r': <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>
    <span class="kw">val</span> <a class="pp">rs'<span class="pc">rs': <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_eq__eq_">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(==): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a> <span class="kw">then</span> <a class="pp" href="std_core_types-source.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>, <a class="pp">rs<span class="pc">rs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>) <span class="kw">else</span> <a class="pp">rs<span class="pc">rs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>
    <span class="kw">val</span> <a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2902</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_eq__eq_">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(==): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a> <span class="kw">then</span> (<a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> ((<span class="op">$</span><span class="number">2902</span>, <span class="op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">2902</span>)</span></a>)(<a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a>, (<a class="pp" href="std_core_types-source.html#ref_fs__excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span><span class="lq">ref<span class="fslash">/</span></span>(!): <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">2904</span>,vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span><span class="op">&gt;</span>, @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">2904</span>,vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,exn,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span><br>?hdiv=iev@3405</span></a><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,exn,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">2904</span>,vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)[<a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a>]) <span class="kw">else</span> <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a>
    <span class="kw">if</span> <a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_eq__eq_">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(==): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a> <a class="pp" href="std_core_types-source.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a> <a class="pp">p<span class="pc">p: <span class="tp sp">(</span><span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a>(<a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2902</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp op">$</span><span class="number">2902</span>)</span></a> <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
    <a class="pp">big-step<span class="pc">big<span class="dash">-</span>step: <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">rs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> (int, <span class="op">$</span><span class="number">2902</span>)</span></a>(<a class="pp">l'<span class="pc">l': <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="std_core_undiv-source.html#pretend_decreasing">pretend-decreasing<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>undiv<span class="fslash last">/</span></span>pretend<span class="dash">-</span>decreasing: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a>, <a class="pp">r'<span class="pc">r': <span class="tp">int</span></span></a>, <a class="pp">rs'<span class="pc">rs': <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>, <a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2902</span></span></a></span>)
  <span class="kw">inline</span> <span class="decl-fun" id="small_step"><span class="kw">fun</span> <a class="pp">small-step<span class="pc">small<span class="dash">-</span>step: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core_types-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="co">V</span></span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a><a class="pp">)<span class="pc">result: <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a>
    <span class="kw">if</span> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_gt__eq_">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&gt;=): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <span class="kw">then</span>
      <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>
    <span class="kw">else</span>
      <span class="kw">val</span> <a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2902</span></span></a> <span class="kw">=</span> (<a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_mul">mul<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> ((<span class="op">$</span><span class="number">2902</span>, <span class="op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">$</span><span class="number">2902</span>)</span></a>)(<a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a>, (<a class="pp" href="std_core_types-source.html#ref_fs__excl_">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span><span class="lq">ref<span class="fslash">/</span></span>(!): <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp op">&lt;$</span><span class="number">2904</span>,vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span><span class="op">&gt;</span>, @implicit<span class="fslash">/</span>hdiv <span class="tp kw op">:</span> <span class="tp">hdiv</span><span class="tp op">&lt;$</span><span class="number">2904</span>,vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span>,<span class="op">&lt;</span>exn,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,exn,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span><br>?hdiv=iev@3689</span></a><a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_prod">prod<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>prod: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,exn,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> ref<span class="op">&lt;$</span><span class="number">2904</span>,vector<span class="op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span><span class="op">&gt;</span></span></a>)[<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;</span>,exn,div<span class="op">|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>])
      <span class="kw">if</span> <a class="pp">p<span class="pc">p: <span class="tp sp">(</span><span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a>(<a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2902</span></span></a>) <span class="kw">then</span>
        <a class="pp">small-step<span class="pc">small<span class="dash">-</span>step: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a>)
      <span class="kw">else</span>
        <a class="pp">small-step<span class="pc">small<span class="dash">-</span>step: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">2<span class="pc">literal: <span class="tp">int</span><br>dec  = 2<br>hex8 = 0x02<br>bit8 = 0b00000010</span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">1<span class="pc">literal: <span class="tp">int</span><br>dec  = 1<br>hex8 = 0x01<br>bit8 = 0b00000001</span></a>, <a class="pp">pl'<span class="pc">pl': <span class="tp op">$</span><span class="number">2902</span></span></a></span>)
  <span class="kw">val</span> <a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">bi<span class="pc">bi: <span class="tp">int</span></span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Tuple2"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Tuple2: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span> <a class="pp">big-step<span class="pc">big<span class="dash">-</span>step: <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">r</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">rs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> (int, <span class="op">$</span><span class="number">2902</span>)</span></a>(<a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a>, <a class="pp">end<span class="pc">end: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a>, <a class="pp" href="std_core_types-source.html#con_space_Nil"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="std_core_types-source.html#con_space_Nil"><span class="co">]</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>, <a class="pp">@implicit/monoid<span class="pc"><span class="lq">?</span>monoid: <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="ck_algebra_monoid-source.html#monoid_fs_one">one<span class="pc"><span class="mo">ck<span class="fslash">/</span>algebra<span class="fslash">/</span>monoid<span class="fslash last">/</span></span><span class="lq">monoid<span class="fslash">/</span></span>one: <span class="tp sp">(</span><span class="tp tpp">monoid</span> <span class="tp kw op">:</span> <span class="tp">monoid</span><span class="tp op">&lt;$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> <span class="op">$</span><span class="number">2902</span></span></a>)
  <span class="kw">val</span> <a class="pp">si<span class="pc">si: <span class="tp">int</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp">bi<span class="pc">bi: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> bool</span></a> <a class="pp">end<span class="pc">end: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <span class="kw">then</span> <a class="pp">small-step<span class="pc">small<span class="dash">-</span>step: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">pl</span> <span class="tp kw op">:</span> <span class="tp op">$</span><span class="number">2902</span>) <span class="kw op">-></span> <span class="op">&lt;</span>pure,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a>(<a class="pp">bi<span class="pc">bi: <span class="tp">int</span></span></a>, <a class="pp">pl<span class="pc">pl: <span class="tp op">$</span><span class="number">2902</span></span></a>) <span class="kw">else</span> <a class="pp">bi<span class="pc">bi: <span class="tp">int</span></span></a>
  <a class="pp">si<span class="pc">si: <span class="tp">int</span></span></a> <a class="pp" href="std_core_int-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>int<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a> <a class="pp">seg<span class="pc">seg: <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#segtree_fs_leaf_count">leaf-count<span class="pc"><span class="mo">ck<span class="fslash">/</span>segtree<span class="fslash last">/</span></span><span class="lq">segtree<span class="fslash">/</span></span>leaf<span class="dash">-</span>count: <span class="tp sp">(</span><span class="tp tpp">segtree</span> <span class="tp kw op">:</span> <span class="tp">segtree</span><span class="tp op">&lt;$</span><span class="number">2904</span>,<span class="op">$</span><span class="number">2902</span><span class="op">&gt;</span>) <span class="kw op">-></span> <span class="op">&lt;</span>div,exn,read<span class="op">&lt;$</span><span class="number">2904</span><span class="op">&gt;|$</span><span class="number">2903</span><span class="op">&gt;</span> int</span></a></span>
</pre>

</body>
</html>
